<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>핀팩토리 주문신청</title>
    <link rel="stylesheet" href="../css/reset.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css" />
    <link rel="stylesheet" href="../css/common.css" />
    <link rel="stylesheet" href="../css/style.css" />
    <script src="../js/jquery-1.12.4.min.js"></script>
    <script src="../js/jquery-migrate-1.4.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
    <script src="https://kit.fontawesome.com/c56cffabac.js" crossorigin="anonymous"></script>
    <script src="../js/nav.js"></script>
    <script src="../js/main.js"></script>
  </head>
  <body>
    <div id="wrap">
      <header id="header">
        <div class="inner">
          <div class="header-top">
            <h1>
              <a href="../index.html"><img src="../img/logo.png" alt="" /></a>
            </h1>

            <div class="m_wrapper_btn">
              <div class="m_menu_ico">
                <span></span>
                <span></span>
                <span></span>
              </div>
            </div>
          </div>

          <div class="header-bottom">
            <h2><span>로그인</span>을 해주세요</h2>
            <ul>
              <li><a href="../../sub/inc/login.html">로그인</a></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="mgnb_wrap" id="mgnbWrap">
        <nav>
            <ul id="mgnb" class="mgnb">
                <li>
                    <a href="#!">
                        <figure>
                            <img src="../img/menu-ico-notice.png" alt="">
                            <figcaption>공지사항</figcaption>
                        </figure>
                    </a>
                </li>
                <li>
                    <a href="#!">
                        <figure>
                            <img src="../img/menu-ico-faq.png" alt="">
                            <figcaption>FAQ</figcaption>
                        </figure>
                    </a>
                </li>
                <li>
                    <a href="#!">
                        <figure>
                            <img src="../img/menu-ico-barcord.png" alt="">
                            <figcaption>구매코드 확인</figcaption>
                        </figure>
                    </a>
                </li>
                <li>
                    <a href="#!">
                        <figure>
                            <img src="../img/menu-ico-coupon.png" alt="">
                            <figcaption>구매 상품권</figcaption>
                        </figure>
                    </a>
                </li>
                <li>
                    <a href="#!">
                        <figure>
                            <img src="../img/menu-ico-cart.png" alt="">
                            <figcaption>장바구니</figcaption>
                        </figure>
                    </a>
                </li>
                <li>
                    <a href="#!">
                        <figure>
                            <img src="../img/menu-ico-mypage.png" alt="">
                            <figcaption>마이페이지</figcaption>
                        </figure>
                    </a>
                </li>
            </ul>
            <div class="m-bottom-btn">
                <a href="#!" >개인정보 수정하기</a>
                <a href="#!" class="btn_out">탈퇴하기</a>
            </div>
        </nav>
      </div>
      <script>
        function member_leave2()
        {
            return confirm('정말 회원에서 탈퇴 하시겠습니까?')
        }
      </script>
      <main id="container">
        <div id="contentsWrap">      
            <section id="sub-visual">
                <figure>
                    <img src="../img/order-comp-bg.png" alt="" />
                </figure>
                <div class="sub-tit">
                    <h2>주문 신청</h2>
                    <p>원하는 상품을 주문하세요!</p>
                </div>
            </section>
    
            <section id="sub-cont">
                <article class="sbbn">
                    <ul>
                        <li>
                            <a href="../../sub/inc/login.html">
                                <div>
                                    <figure>
                                        <img src="../img/ico-barcode.png" alt="" />
                                    </figure>
                                    <em>구매코드 확인</em>
                                </div>
                            </a>
                        </li>
                    </ul>
                </article>
    
                <article class="main-section">
                  <div class="wrap-main">
                    <div class="wrap-left">
                        <div class="item-form">
                            <form name="frm_list" id="frm_list" method="post">
                                <input type="hidden" name="ca_id" value="30">
                                <input type="hidden" name="sw_direct" value="">
                                <input type="hidden" name="act" value="">
                                <header>
                                    <b class="bold">해피머니</b>
                                    <ul class="sale" style="display: none">
                                        <li class="blue">계좌이체 <span class="text-white blue-bg">최대 7%</span></li>
                                        <li class="green">카드 <span class="text-white green-bg">최대 1%</span></li>
                                    </ul>
                                </header>
                                <div class="item-body flex">
                                    <figure>
                                        <img src="http://pinfactory2.tium.co.kr/data/category/30/990697551_3nWqBkdt_c0ab03fcad03c2f408915e94de516bc334a14d39.jpg" alt="">
                                    </figure>
                                    <div class="inputs">
                                        <div class="pay-way">
                                            <b>결제방법</b>
                                            <ul>
                                                <li><label class="on" data-paytype="1"><input hidden type="radio" name="payWay" checked>계좌이체(무통장입금)</label></li>
                                                <li><label  data-paytype="2"><input hidden type="radio" name="payWay">카드결제</label></li>
                                                <li><label  data-paytype="3"><input hidden type="radio" name="payWay">휴대폰 결제</label></li>
                                                <input type="hidden" name="pay_type" value="1">
                                            </ul>
                                        </div>
                                        <div class="purchase-count">
                                            <b>구매수량</b>
                                            <ul class="count-ctrl" id="buy_layer">
                                                <li>구매제한된 제품입니다.</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <div class="item-footer flex">
                                    <div class="item-caution">
                                        <b><img src="../img/caution.png" alt="구매전 공지">구매전 공지</b>
                                        <ul class="caution-ul">
                                            <li>- 상품권은 PIN번호 발권 후에는 <span class="theme">교환,취소,환불이 불가</span>합니다.</li>
                                            <li>- 한번의 주문에 계좌이체, 카드결제, 휴대폰 결제를 <span class="theme">중복으로 사용불가</span>합니다.</li>
                                            <li>- <span class="theme">장바구니 담기</span>는 똑같은 결제 방식의 상품만 담을 수 있습니다.</li>
                                        </ul>
                                    </div>
                                    <div class="item-form-end">
                                        <div class="total">
                                            <p>총 결제금액:</p>
                                            <p><span class="bold theme totprice">0</span>원</p>
                                        </div>
                                        <div class="buttons">
                                            <button type="button" class="theme-bg text-white direct_buy" >바로 구매하기</button>
                                            <button type="button" class="black-bg text-white cart_btn">장바구니</button>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div class="item-datail">
                            <ul class="item-datail-tab">
                                <li><a href="#!" class="on">제품상세</a></li>
                                <li><a href="#!">리뷰</a></li>
                            </ul>
                            <div class="item-datil-wrap">
                                <article class="on">
                                    <p><img src="https://nowpin.co.kr:9136/data/editor/2305/d58c56bab8ec9cdbff3cda4a2d8d81b2_1684988404_6298.jpg" title="d58c56bab8ec9cdbff3cda4a2d8d81b2_1684988404_6298.jpg"><br style="clear:both;">&nbsp;</p>
                                </article>
                                <article>
                                    <meta name="robots" content="noindex, nofollow">        
                                    <div id="sit_use_wbtn">
                                        <a href="http://pinfactory2.tium.co.kr/shop/itemuseform.php?ca_id=30" class="qa_wr itemuse_form " onclick="return false;">사용후기 쓰기<span class="sound_only"> 새 창</span></a>
                                        <a href="http://pinfactory2.tium.co.kr/shop/itemuselist.php" id="itemuse_list" class="btn01">더보기</a>
                                    </div>
        
                                    <!-- 상품 사용후기 시작 { -->
                                    <div id="sit_use_list">
                                  
                                      <p class="sit_empty">사용후기가 없습니다.</p>
                                    </div>
                                    
        
                <script>
                $(function(){
                    $(".itemuse_form").click(function(){
                        window.open(this.href, "itemuse_form", "width=810,height=680,scrollbars=1");
                        return false;
                    });
                
                    $(".itemuse_delete").click(function(){
                        if (confirm("정말 삭제 하시겠습니까?\n\n삭제후에는 되돌릴수 없습니다.")) {
                            return true;
                        } else {
                            return false;
                        }
                    });
                
                    $(".sit_use_li_title").click(function(){
                        var $con = $(this).siblings(".sit_use_con");
                        if($con.is(":visible")) {
                            $con.slideUp();
                        } else {
                            $(".sit_use_con:visible").hide();
                            $con.slideDown(
                                function() {
                                    // 이미지 리사이즈
                                    $con.viewimageresize2();
                                }
                            );
                        }
                    });
                
                    $(".pg_page").click(function(){
                        $("#itemuse").load($(this).attr("href"));
                        return false;
                    });
                
                    $("a#itemuse_list").on("click", function() {
                        window.opener.location.href = this.href;
                        self.close();
                        return false;
                    });
                });
                </script>
                <!-- } 상품 사용후기 끝 -->                        
                </article>
                                    </div>
                        </div>
                    </div>
                  </div>
                </article>
            </section>
            <script>
            /* document.addEventListener('DOMContentLoaded',()=>{
                // controlling count
                const countNum_minus = document.querySelectorAll('.ctrller .decrease');
                const countNum_plus = document.querySelectorAll('.ctrller .increase');
                countNum_minus.forEach(el=>{
                    el.addEventListener('click',()=>{
                        let currentValue =  el.nextElementSibling.value;
                        currentValue > 0
                            ? el.nextElementSibling.value = currentValue - 1
                            : el.nextElementSibling.value = 0;
                    })
                })
                countNum_plus.forEach(el=>{
                    el.addEventListener('click',()=>{
                        let currentValue =  el.previousElementSibling.value;
                        el.previousElementSibling.value = Number(currentValue) + 1
                    })
                })
    
                //payment way
                const payway = document.querySelectorAll('.pay-way label');
                let paycheck ="";
                payway.forEach(el => {
                    el.addEventListener('click',()=>{
                        document.querySelector('.pay-way label.on').classList.remove('on');
                        el.classList.add('on');
                        paycheck = el.dataset['paytype'];
                        if(paycheck){
                            alert(0);
                            document.getElementsByName('pay_type').value = paycheck;
                        }
    
                    })
    
                })
    
                //datils tap
                const tabDetail = document.querySelectorAll('.item-datail-tab a');
                const tabTarget = document.querySelectorAll('.item-datil-wrap article');
                tabDetail.forEach(el => {
                    el.addEventListener('click',()=>{
                        const idx = [...el.parentElement.parentElement.children].indexOf(el.parentElement);
                        document.querySelector('.item-datail-tab a.on').classList.remove('on');
                        el.classList.add('on');
                        document.querySelector('.item-datil-wrap article.on').classList.remove('on');
                        tabTarget[idx].classList.add('on');
                    })
                })
            })*/
            $(function(){
                let pay_check ="";
                $(".pay-way label").each(function(){
                    if($(this).hasClass('on')){
                        pay_check = $(this).data('paytype');
                    }
                });
                if(pay_check)
                    get_list();
                $(".pay-way label").click(function(){
                    $(".pay-way label").removeClass('on');
                    $(this).addClass('on');
                    pay_check =  $(this).data('paytype');
                    $("input[name='pay_type']").val(pay_check);
                    get_list();
    
                });
                //수량 더하기 버튼 클릭시
                $(document).on("click",".increase",function(){
                    let qty_layer = $(this).parent().find('input[name^=qty]');
                    let qty_val = parseInt(qty_layer.val())+1;
                    qty_layer.val(qty_val);
                    get_list();
                });
                //수량 빼기 버튼 클릭시
                $(document).on("click",".decrease",function(){
                    let qty_layer = $(this).parent().find('input[name^=qty]');
                    let qty_val = parseInt(qty_layer.val())-1;
                    if(qty_val < 0)
                        qty_val =0;
                    qty_layer.val(qty_val);
                    get_list();
                });
                //바로구매
                $(".direct_buy").click(function(){
                    let qty =0;
                    $("input[name ^='qty']").each(function(){
                        qty+= parseInt($(this).val());
                    });
                    if(qty <1){
                        alert("한개이상 선택하셔야 주문이 가능합니다.");
                        return false;
                    }
                    let form = $(this).closest('form');
                    if (form.length) {
                        // 폼 요소 처리 예시: submit
                        form.attr('action','./new_cartupdate.php');
                        $("input[name='sw_direct']").val(1);
                        //$("input[name='act']").val('buy');
                        form.submit();
                    }
                });
    
                //장바구니
                $(".cart_btn").click(function(){
                    let qty =0;
                    $("input[name ^='qty']").each(function(){
                        qty+= parseInt($(this).val());
                    });
                    if(qty <1){
                        //alert("한개이상 선택하셔야 주문이 가능합니다.");
                        location.href="./cart.php";
                        return false;
                    }
                    let form = $(this).closest('form');
                    if (form.length) {
                        // 폼 요소 처리 예시: submit
                        form.attr('action','./new_cartupdate.php');
    
                        //$("input[name='act']").val('buy');
                        form.submit();
                    }
                });
    
    
            })
            //상품리스트 가져오기
            function get_list(pay_type){
                let formData = $("#frm_list").serialize();
                //formData+="&pay_type="+pay_type;
                //console.log(formData);
                $.ajax({
                    type:"POST",
                    url     : "/ajax/get_list.php",
                    data    : formData,
                    cache   : false,
                    async: false,
    
                    success : function(data) {
                        //console.log(data);
                        $("#buy_layer").empty();
                        $("#buy_layer").html(data);
                        let totprice = $("input[name='totprice']").val();
                        $(".totprice").text(number_format(totprice));
                        //alert(data);
                        //location.reload();
                    },
                    error:function(request,status,error){
                        alert("code:"+request.status+"\n"+"message:"+request.responseText+"\n"+"error:"+error);
                    }
                });
            }
    
            //datils tap
            const tabDetail = document.querySelectorAll('.item-datail-tab a');
            const tabTarget = document.querySelectorAll('.item-datil-wrap article');
            tabDetail.forEach(el => {
                el.addEventListener('click',()=>{
                    const idx = [...el.parentElement.parentElement.children].indexOf(el.parentElement);
                    document.querySelector('.item-datail-tab a.on').classList.remove('on');
                    el.classList.add('on');
                    document.querySelector('.item-datil-wrap article.on').classList.remove('on');
                    tabTarget[idx].classList.add('on');
                })
            })
            </script>
        
        </div>      
      </main>
      <footer id="footer">
        <div class="footer-top">
          <div class="inner">
            <figure>
              <img src="../img/saletime.png" alt="" />
              <figcaption>
                홈페이지 판매
                <br />
                <span>연중 무휴 24시간 자동 운영</span>
              </figcaption>
            </figure>
            <div class="counseling">
              <figure>
                <img src="../img/ico-counseling2.png" alt="" />
                <figcaption>010-9351-5185</figcaption>
              </figure>
              <ul>
                <li>
                  상담원 연락 가능 시간 : 오전 10시 ~ 새벽 1시 <br />(전화,
                  문자, 카카오톡)
                </li>
                <li>
                  그 외 시간은 <span>1:1 문의</span>를 통해 상담 요청
                  가능합니다.
                </li>
              </ul>
              <a href="#!">1:1 문의 바로가기</a>
            </div>
          </div>
        </div>
        <div class="footer-bottom">
            <div class="fb-top">
              <div class="inner">
              <figure>
                <img src="../img/logo.png" alt="" />
              </figure>

              <ul>
                <li>
                  <a href="#!">
                    <img src="../img/ico-facebook.png" alt="" />
                  </a>
                </li>
                <li>
                  <a href="#!">
                    <img src="../img/ico-instagram.png" alt="" />
                  </a>
                </li>
                <li>
                  <a href="#!">
                    <img src="../img/ico-youtube.png" alt="" />
                  </a>
                </li>
              </ul>
              </div>
            </div>
            <div class="fb-mid">
              <div class="inner">
                <ul>
                  <li><a href="#!">회사소개</a></li>
                  <li><a href="#!">이용약관</a></li>
                  <li><a href="#!">상품권 이용약관</a></li>
                  <li><a href="#!">개인정보처리 방침</a></li>
                </ul>
              </div>
            </div>
            <div class="fb-bot">
              <div class="inner">
              <p>통신판매업신고번호 : 제 2017-성남분당-0873호</p>
              <p><a href="#!">[사업자정보확인]</a></p>
              <p>
                주소 : 경기도 성남시 분당구 백현로 97,12층 1233호(수내동
                수내동다운 타운) | 대표번호 : 010-9351-5185 | 카카오톡 ID :
                pinfactory55 이메일 : pinfactory55@gmail.com
              </p>
            </div>
          </div>
          <p class="copy">Copyright. ⓒ 핀팩토리. All Rights Reserved.</p>
        </div>
      </footer>
      <div class="gotop">
        <a href="#">
            <img src="../img/top-btn.png" alt="">
        </a>
      </div>
    </div>
  </body>
</html>
